name: "tg_messenger"
description: "–°–µ—Ä–≤–∏—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram —á–µ—Ä–µ–∑ Bot API."
edition: "base"
dependencies:
  - "logger"
  - "database_service"
  - "tg_bot_initializer"
  - "tg_button_mapper"
  - "settings_manager"
optional_dependencies:
  - "placeholder_processor"
settings:
  queue_read_interval:
    type: float
    default: 0.1
    description: |
      –ò–Ω—Ç–µ—Ä–≤–∞–ª (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö) –º–µ–∂–¥—É —á—Ç–µ–Ω–∏–µ–º –æ—á–µ—Ä–µ–¥–∏ –¥–µ–π—Å—Ç–≤–∏–π. –ß–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç —Å–µ—Ä–≤–∏—Å.. 
  queue_batch_size:
    type: integer
    default: 50
    description: |
      –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö –∑–∞ –æ–¥–Ω—É –∏—Ç–µ—Ä–∞—Ü–∏—é —á—Ç–µ–Ω–∏—è –æ—á–µ—Ä–µ–¥–∏ (batch). 
      –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–±–∏—Ä–∞—Ç—å —Å—Ä–∞–∑—É –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

  parse_mode:
    type: string
    default: "HTML"
    description: "–†–µ–∂–∏–º —Ä–∞–∑–º–µ—Ç–∫–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π (HTML, MarkdownV2 –∏–ª–∏ None)"
  callback_edit_default:
    type: boolean
    default: true
    description: "–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ callback, –µ—Å–ª–∏ —è–≤–Ω–æ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏"
  enable_placeholder:
    type: boolean
    default: true
    description: "–ï—Å–ª–∏ true ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤ —Ç–µ–∫—Å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ placeholder_processor"
actions:
  send:
    description: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç –∏–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ (–µ—Å–ª–∏ callback_edit=true)."
    required_data:
      - chat_id
      - user_id
      - message_id
    config_attrs:
      text:
        type: string
        description: "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç HTML-—Ä–∞–∑–º–µ—Ç–∫—É –∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã {–∏–º—è_–ø–æ–ª—è})"
      additional_text:
        type: string
        description: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ç–µ–∫—Å—Ç—É –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ü–µ–ø–æ—á–µ–∫ –¥–µ–π—Å—Ç–≤–∏–π, –≥–¥–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—á–Ω—ã–π —Ç–µ–∫—Å—Ç –∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º—É —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É."
      inline:
        type: array
        description: "Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ (–º–∞—Å—Å–∏–≤ –º–∞—Å—Å–∏–≤–æ–≤ —Å—Ç—Ä–æ–∫ –∏–ª–∏ —Å–ª–æ–≤–∞—Ä–µ–π)"
      reply:
        type: array
        description: "Reply-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ (–º–∞—Å—Å–∏–≤ –º–∞—Å—Å–∏–≤–æ–≤ —Å—Ç—Ä–æ–∫)"
      message_reply:
        type: boolean
        description: "–ï—Å–ª–∏ true ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–∞–∫ reply (–æ—Ç–≤–µ—Ç) –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (reply_to_message_id –∏–∑ message_id)"
      exact_message_id:
        type: integer
        description: "–¢–æ—á–Ω—ã–π ID —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–¥–º–µ–Ω—ã. –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω, –∑–∞–º–µ–Ω—è–µ—Ç message_id –∏–∑ action_data –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, reply –∏ –¥—Ä—É–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π"
      callback_edit:
        type: boolean
        description: "–ï—Å–ª–∏ true ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–æ–≤–æ–≥–æ"
      remove:
        type: boolean
        description: "–ï—Å–ª–∏ true ‚Äî —É–¥–∞–ª–∏—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–æ–≤–æ–≥–æ"
      attachment:
        type: [string, object, array]
        description: "–í–ª–æ–∂–µ–Ω–∏–µ (—Ñ–∞–π–ª, –º–µ–¥–∏–∞, –º—É–∑—ã–∫–∞ –∏ —Ç.–ø.). –ú–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–ª–æ–∂–µ–Ω–∏–π."
      parse_mode:
        type: string
        description: "–†–µ–∂–∏–º —Ä–∞–∑–º–µ—Ç–∫–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è (HTML –∏–ª–∏ MarkdownV2). –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω, –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π parse_mode –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–µ—Ä–≤–∏—Å–∞."
      private_answer:
        type: boolean
        description: "–ï—Å–ª–∏ true ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –ª–∏—á–Ω—ã–π —á–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (user_id), –∞ –Ω–µ –≤ –≥—Ä—É–ø–ø—É. –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–∏–ø–∞ send."
      placeholder:
        type: boolean
        description: "–ï—Å–ª–∏ false ‚Äî –æ—Ç–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤ –¥–ª—è —ç—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (–∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π enable_placeholder)"
    response_data:
      last_message_id:
        type: integer
        description: "ID –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)"
      error:
        type: string
        description: "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏"
    details: |
      –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç HTML-—Ä–∞–∑–º–µ—Ç–∫—É: <b>–∂–∏—Ä–Ω—ã–π</b>, <i>–∫—É—Ä—Å–∏–≤</i>, <u>–ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—ã–π</u>
      
      Inline –∫–Ω–æ–ø–∫–∏ (inline) –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:
      
      ‚Ä¢ "–¢–µ–∫—Å—Ç" ‚Äî –æ–±—ã—á–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Å callback_data (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç)
      ‚Ä¢ {"–¢–µ–∫—Å—Ç": "scenario_name"} ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å—Ü–µ–Ω–∞—Ä–∏—é (callback_data: :scenario_name)
      ‚Ä¢ {"–¢–µ–∫—Å—Ç": "https://example.com"} ‚Äî URL –∫–Ω–æ–ø–∫–∞ (–µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Å—Å—ã–ª–∫—É)
      
      –ü—Ä–∏–º–µ—Ä—ã inline –∫–Ω–æ–ø–æ–∫:
        - [{"–ù–∞–∑–∞–¥": "start_menu"}, {"–ü–æ–º–æ—â—å": "help"}]
        - [{"üåê –°–∞–π—Ç": "https://example.com"}, {"üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã": "https://t.me/your_bot"}]
        - [{"‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å": "confirm_action"}, {"‚ùå –û—Ç–º–µ–Ω–∞": "cancel_action"}]
      
      –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: URL –∫–Ω–æ–ø–∫–∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç callback –≤ –±–æ—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ.

  remove:
    description: "–£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —á–∞—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç message_id –∏–∑ action_data."
    required_data:
      - chat_id
      - message_id
    config_attrs:
      remove_message_id:
        type: integer
        description: "ID —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è. –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω, —É–¥–∞–ª—è–µ—Ç –∏–º–µ–Ω–Ω–æ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∏–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç message_id –∏–∑ action_data."
    response_data:
      error:
        type: string
        description: "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏"
features:
  - "–û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç"
  - "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç—Ä–µ–±—É–µ—Ç message_id)"
  - "–£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —á–∞—Ç–∞ (—Ç—Ä–µ–±—É–µ—Ç message_id)"
  - "–ü–æ–¥–º–µ–Ω–∞ message_id —á–µ—Ä–µ–∑ exact_message_id –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è"
  - "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ inline –∏ reply –∫–ª–∞–≤–∏–∞—Ç—É—Ä (–º–∞—Å—Å–∏–≤ –º–∞—Å—Å–∏–≤–æ–≤ —Å—Ç—Ä–æ–∫ –∏–ª–∏ —Å–ª–æ–≤–∞—Ä–µ–π –¥–ª—è —è–≤–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å—Ü–µ–Ω–∞—Ä–∏—é)"
  - "–í–ª–æ–∂–µ–Ω–∏—è –ª—é–±–æ–≥–æ —Ç–∏–ø–∞ (attachment), –º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à—Ç—É–∫ –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏"
  - "Inline-–∫–Ω–æ–ø–∫–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å callback_data —Å —è–≤–Ω—ã–º —Å—Ü–µ–Ω–∞—Ä–∏–µ–º (:scenario_name) –¥–ª—è –ø—Ä—è–º–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –Ω—É–∂–Ω–æ–º—É —Å—Ü–µ–Ω–∞—Ä–∏—é"
  - "HTML-—Ä–∞–∑–º–µ—Ç–∫–∞ –≤ —Ç–µ–∫—Å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–π (<b>, <i>, <u>, <s>, <code>)"
  - "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç (additional_text) –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ —Ü–µ–ø–æ—á–∫–∞—Ö –¥–µ–π—Å—Ç–≤–∏–π"
  - "–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —á–µ—Ä–µ–∑ enable_placeholder)"
  - "–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ª–∏—á–Ω—ã–π —á–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (private_answer)" 