# [Unreleased]

*Последний коммит для анализа: `0d2eb10` (2025-09-20)*

## [5.1]

### Fixed
- **Исправлена обработка сигналов в приложении** — устранен конфликт между `signal.signal()` и `asyncio.run()`, приложение теперь корректно завершается при Ctrl+C
- **Исправлена логика проверки контейнеров** — команды теперь правильно определяют существующие остановленные контейнеры и запускают их вместо создания новых
- **Исправлена архитектура Docker команд** — перенесены методы работы с контейнерами из `CoreUpdater` в `DockerManager` для правильного разделения ответственности
- **Исправлены хардкоды в командах** — все сообщения теперь используют корректное имя контейнера вместо статичного `command`

### Enhanced
- **Улучшена читаемость интерфейса** — добавлены отступы между блоками вывода для лучшего восприятия
- **Добавлена опция выхода** — при вводе имени контейнера можно ввести `0` для возврата в главное меню
- **Упрощена логика именования контейнеров** — удалена избыточная переменная `CONTAINER_STATS_NAME`, везде используется `COMMAND_NAME`
- **Улучшена логика поиска проекта** — `find_project_dir()` теперь использует правильное имя контейнера без сложных условий
- **Автоматические отступы для ввода** — все поля `safe_input` теперь автоматически отделены от вывода
- **Улучшена обработка переменных окружения** — добавлена загрузка `.env` файла в `core_updater.py`

### Changed
- **Переименование скрипта** — `coreness` переименован в `command` для универсальности
- **Обновлена документация** — отражены изменения в названии команд

### Technical Details
- **Архитектурные улучшения**: четкое разделение ответственности между `CoreUpdater` (координация) и `DockerManager` (Docker операции)
- **Упрощение кода**: удаление дублирующих переменных и сложной логики
- **Улучшение UX**: визуальное разделение блоков информации и интуитивные опции выхода
- **Улучшенная обработка окружения**: автоматическая загрузка переменных из `.env` файла

## [5.0]

### Added
- **Docker контейнеризация** — полная поддержка развертывания через Docker с автономным образом
- **Автоматический установщик** — единый скрипт `core_updater.py` для установки и обновления
- **Глобальные команды управления** — универсальный скрипт `command` для управления системой
- **Интерактивное меню** — удобное меню с 4 основными пунктами (Docker, обновление, миграция, зависимости)
- **Динамический прогресс** — отображение логов в реальном времени с прогрессом выполнения
- **Система зависимостей** — автоматическая установка Python пакетов и системных зависимостей
- **Команда экстренной остановки** — `command kill` для быстрой остановки всех Docker процессов

### Changed
- **Архитектура развертывания** — переход на контейнерную архитектуру
- **Упрощенная структура** — единая конфигурация вместо dev/prod
- **Логика установки** — объединены установка и обновление в единый скрипт
- **Улучшенный статус** — отображение статуса контейнера и приложения с детальной информацией
- **Умный перезапуск** — проверка работающих процессов перед запуском новых
- **Упрощенный деплой гайд** — краткие и понятные инструкции по установке

### Fixed
- **Исправлена обработка недоступности бота** — предотвращение бесконечных циклов polling при отсутствии токена
- **Улучшена система команд Telegram** — добавлены проверки доступности бота перед регистрацией команд
- **Исправлено дублирование логов** — реализовано кэширование переменных окружения в SettingsManager
- **Улучшен fallback пресетов** — корректная обработка несуществующих пресетов с автоматическим переходом на default
- **Исправлена работа с Docker** — решение проблем с CRLF окончаниями строк в скриптах

### Enhanced
- **Улучшен скрипт деплоя** — увеличен лимит поиска версий с 10 до 50 попыток для активных релизов
- **Расширены возможности command** — добавлена поддержка параметра количества строк в `app-logs`
- **Улучшена остановка приложения** — двухэтапная остановка (SIGTERM → SIGKILL) с детальной диагностикой
- **Глобальные команды** — команды `command` работают из любой директории сервера
- **Разделение управления** — отдельные команды для контейнера (`start`, `stop`, `restart`) и приложения (`app-start`, `app-stop`, `app-restart`)

### Technical Details
- **Docker конфигурация**: `docker-compose.yml` с монтированием всего проекта
- **Автономный образ**: все Python зависимости в образе, не требует `requirements.txt` на хосте
- **Система обновлений**: поддержка Base/Pro версий с GitHub токенами

